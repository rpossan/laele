<div class="max-w-4xl mx-auto space-y-6">
  <!-- Step Indicator -->
  <div class="text-center space-y-4">
    <div class="inline-flex items-center gap-2 rounded-full bg-emerald-50 text-emerald-700 px-4 py-2 text-xs font-semibold uppercase tracking-wider">
      <span class="inline-flex h-6 w-6 items-center justify-center rounded-full bg-emerald-600 text-white font-bold">3</span>
      <span><%= t('plans.step_3') %></span>
    </div>
    <h1 class="text-3xl font-bold text-slate-900"><%= t('google_ads.choose_main_account') %></h1>
    <p class="text-lg text-slate-600"><%= t('google_ads.choose_main_account_description') %></p>
  </div>

  <!-- Selected Plan Summary -->
  <% if @selected_plan %>
    <div class="rounded-2xl border border-emerald-200 bg-emerald-50 p-4 shadow-sm">
      <div class="flex items-center gap-4">
        <div class="flex-shrink-0 h-10 w-10 rounded-full bg-emerald-100 flex items-center justify-center">
          <svg class="h-5 w-5 text-emerald-600" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </div>
        <div class="flex-1">
          <p class="text-sm text-emerald-600 font-medium"><%= t('plans.selected_plan') %></p>
          <p class="text-lg font-bold text-emerald-800">
            <%= t("plans.#{@selected_plan.slug}.name", default: @selected_plan.name) %>
            <% if @selected_plan.per_account? %>
              <span class="text-sm font-normal text-emerald-600">
                (<%= @selected_accounts_count %> <%= t('plans.accounts') %> Ã— <%= number_to_currency(@selected_plan.price_per_account_brl, unit: "R$", format: "%u%n", precision: 0) %> =
                <%= number_to_currency(@selected_accounts_count * @selected_plan.price_per_account_brl, unit: "R$", format: "%u%n", precision: 0) %>/<%= t('pricing.per_month') %>)
              </span>
            <% else %>
              <span class="text-sm font-normal text-emerald-600">
                (<%= number_to_currency(@selected_plan.price_brl, unit: "R$", format: "%u%n", precision: 0) %>/<%= t('pricing.per_month') %>)
              </span>
            <% end %>
          </p>
        </div>
      </div>
    </div>
  <% end %>

  <div class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
    <h2 class="text-xl font-semibold text-slate-900 mb-2"><%= t('google_ads.choose_main_account') %></h2>
    <p class="text-sm text-slate-500 mb-6">
      <%= t('google_ads.main_account_description') %>
    </p>

    <%= form_with url: google_ads_auth_select_path, method: :post, local: true, class: "space-y-4" do |f| %>
      <%= hidden_field_tag :google_account_id, @google_account.id %>
      <%= hidden_field_tag :customer_names, @customer_names.to_json %>

      <div class="space-y-3">
        <% @active_customer_ids.each_with_index do |customer_id, index| %>
          <label class="flex items-center gap-4 rounded-xl border border-slate-200 bg-white hover:border-indigo-200 hover:bg-indigo-50/40 cursor-pointer p-4 shadow-sm transition">
            <%= radio_button_tag :login_customer_id, customer_id, index == 0,
                class: "h-4 w-4 text-indigo-600 focus:ring-indigo-500" %>
            <div class="flex-1">
              <div class="flex items-center gap-2">
                <span class="font-semibold text-slate-900">
                  <%= format_customer_id(customer_id) %>
                </span>
                <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-700">
                  <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                  </svg>
                  <%= t('plans.account_active') %>
                </span>
              </div>
              <% if @customer_names[customer_id].present? %>
                <div class="mt-1 text-sm text-slate-500">
                  <%= @customer_names[customer_id] %>
                </div>
              <% end %>
            </div>
          </label>
        <% end %>
      </div>

      <div class="flex flex-col gap-3 pt-4 sm:flex-row">
        <%= f.submit t('google_ads.confirm_selection'), class: "flex-1 inline-flex items-center justify-center rounded-xl bg-indigo-600 px-6 py-3 text-sm font-semibold text-white shadow-sm hover:bg-indigo-700 transition" %>
        <%= link_to t('common.cancel'), dashboard_path, class: "inline-flex items-center justify-center rounded-xl border border-slate-200 px-6 py-3 text-sm font-medium text-slate-600 hover:text-slate-900 hover:border-slate-300 transition" %>
      </div>
    <% end %>
  </div>

  <div class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
    <h3 class="text-sm font-semibold text-slate-900 mb-2"><%= t('google_ads.selection_info') %></h3>
    <ul class="list-disc list-inside space-y-2 text-sm text-slate-600">
      <li><%= t('google_ads.selection_info_item1') %></li>
      <li><%= t('google_ads.selection_info_item2') %></li>
      <li><%= t('google_ads.selection_info_item3') %></li>
    </ul>
  </div>
</div>
